{"version":3,"sources":["components/filter.js","components/liba/auction-form.js","routes/liba.js","utils/constant.js","utils/liba.js"],"names":["FormItem","Form","Item","Filter","onChange","value","props","name","this","allowClear","label","mode","selectProps","_","omit","className","capitalize","React","PureComponent","defaultProps","disabled","placeholder","AuctionForm","context","handleValueChange","changedValue","setState","handleInitAuction","onClose","form","current","validateFields","err","values","token","bidDuration","revealDuration","claimDuration","challengeDuration","finalizeDuration","duration","maxRate","minValue","collateralAddress","collateralValue","contracts","LiBA","methods","initAuction","cacheSend","web3","utils","toWei","toString","RATE_BASE","state","createRef","drizzle","visible","network","supportedTokenOptions","supportedTokens","map","supportedToken","address","symbol","unit","getUnitByAddress","formItems","field","fieldOptions","options","rules","message","required","currencyFieldOptions","minValueRule","dayFieldOptions","rateFieldOptions","step","precision","RATE_PRECISION","blockFieldOptions","title","onOk","onCancel","ref","items","onValuesChange","Component","contextTypes","PropTypes","object","tabList","key","tab","onTabChange","toggleModal","prevState","isModalVisible","updateFilter","change","filter","renderAuction","auction","asker","tokenAddress","period","actions","to","args","type","span","formatCurrencyValue","renderFilters","periodOptions","ALL_PERIODS","askerOptions","auctions","uniq","style","width","renderAuctions","accounts","getAuction","includes","bids","getCurrentPeriod","getAuctionPeriod","get","grid","gutter","column","dataSource","renderItem","activeTabKey","extra","onClick","drizzleConnect","EMPTY_ADDRESS","BN","BID","REVEAL","CLAIM","CHALLENGE","FINALIZE","FINALIZED","EXPIRED","auctionPeriods","find","auctionPeriod","blockNumber","bidEnd","revealEnd","claimEnd","challengeEnd","finalizeEnd","finalized","toNumber","getWinners","topLoser","winners","remainingValue","sort","compareBid","forEach","bid","bidder","push","last","calculateRepay","result","rate","add","muln","parseInt","divn","bid1","bid2","rate1","celerValue1","celerValue","rate2","celerValue2"],"mappings":"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","file":"static/js/6.5d63207f.chunk.js","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport { Form } from 'antd';\n\nimport Select from './select';\n\nconst FormItem = Form.Item;\n\nexport default class Filter extends React.PureComponent {\n    onChange = value => {\n        const { name, onChange } = this.props;\n\n        if (name) {\n            onChange({ [name]: value });\n            return;\n        }\n\n        onChange(value);\n    };\n\n    render() {\n        const { allowClear, label, name, mode, value } = this.props;\n        const selectProps = {\n            ..._.omit(this.props, ['label', 'name', 'onChange'])\n        };\n\n        if (mode === 'multiple' && !value) {\n            selectProps.value = [];\n        }\n\n        if (!mode && !allowClear) {\n            selectProps.allowClear = false;\n        }\n\n        return (\n            <FormItem\n                className=\"dropdown-filter\"\n                label={label || _.capitalize(name)}\n            >\n                <Select {...selectProps} onChange={this.onChange} />\n            </FormItem>\n        );\n    }\n}\n\nFilter.defaultProps = {\n    disabled: false,\n    label: '',\n    placeholder: 'all'\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport web3 from 'web3';\nimport { Modal } from 'antd';\n\nimport Form from '../form';\nimport {\n    currencyFieldOptions,\n    rateFieldOptions,\n    minValueRule,\n    blockFieldOptions,\n    dayFieldOptions\n} from '../../utils/form';\nimport { getUnitByAddress } from '../../utils/unit';\nimport { RATE_PRECISION, RATE_BASE } from '../../utils/constant';\n\nclass AuctionForm extends React.Component {\n    constructor(props, context) {\n        super(props);\n\n        this.state = {};\n        this.form = React.createRef();\n        this.contracts = context.drizzle.contracts;\n    }\n\n    handleValueChange = changedValue => this.setState(changedValue);\n\n    handleInitAuction = () => {\n        const { onClose } = this.props;\n\n        this.form.current.validateFields((err, values) => {\n            if (err) {\n                return;\n            }\n\n            const {\n                token,\n                bidDuration,\n                revealDuration,\n                claimDuration,\n                challengeDuration,\n                finalizeDuration,\n                value,\n                duration,\n                maxRate,\n                minValue,\n                collateralAddress,\n                collateralValue = 0\n            } = values;\n\n            this.contracts.LiBA.methods.initAuction.cacheSend(\n                token,\n                bidDuration,\n                revealDuration,\n                claimDuration,\n                challengeDuration,\n                finalizeDuration,\n                web3.utils.toWei(value.toString(), 'ether'),\n                duration,\n                maxRate * RATE_BASE,\n                web3.utils.toWei(minValue.toString(), 'ether'),\n                collateralAddress,\n                web3.utils.toWei(collateralValue.toString(), 'ether')\n            );\n            onClose();\n        });\n    };\n\n    render() {\n        const { visible, network, onClose } = this.props;\n        const supportedTokenOptions = network.supportedTokens.map(\n            supportedToken => [\n                supportedToken.address,\n                `${supportedToken.symbol} (${supportedToken.address})`\n            ]\n        );\n        const unit = getUnitByAddress(\n            network.supportedTokens,\n            this.state.token\n        );\n\n        const formItems = [\n            {\n                name: 'token',\n                field: 'select',\n                fieldOptions: {\n                    options: supportedTokenOptions,\n                    placeholder: 'Token type to borrow'\n                },\n                rules: [\n                    {\n                        message: 'Please select a token!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'value',\n                field: 'number',\n                fieldOptions: {\n                    ...currencyFieldOptions(unit),\n                    placeholder: 'The amount of token to borrow'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a value!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'duration',\n                field: 'number',\n                fieldOptions: {\n                    ...dayFieldOptions,\n                    placeholder: 'The duration of the borrowing'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a duration!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'maxRate',\n                label: 'Max Daily Rate',\n                field: 'number',\n                fieldOptions: {\n                    ...rateFieldOptions,\n                    step: 0.1,\n                    precision: RATE_PRECISION,\n                    placeholder: 'The maximum daily interest rate'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a max rate!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'minValue',\n                label: 'Min Value',\n                field: 'number',\n                fieldOptions: {\n                    ...currencyFieldOptions(unit),\n                    placeholder: 'The minimum value for bidding'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a min value!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'collateralAddress',\n                label: 'Collateral Address',\n                fieldOptions: {\n                    placeholder: 'The address of collateral token'\n                }\n            },\n            {\n                name: 'collateralValue',\n                label: 'Collateral Value',\n                field: 'number',\n                fieldOptions: {\n                    placeholder: 'The amount of collateral token'\n                },\n                rules: [minValueRule(0)]\n            },\n            {\n                name: 'bidDuration',\n                label: 'Bid Duration',\n                field: 'number',\n                fieldOptions: {\n                    ...blockFieldOptions,\n                    placeholder: 'The duration of bidding period'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a duration!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'revealDuration',\n                label: 'Reveal Duration',\n                field: 'number',\n                fieldOptions: {\n                    ...blockFieldOptions,\n                    placeholder: 'The duration of revealing period'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a duration!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'claimDuration',\n                label: 'Claim Duration',\n                field: 'number',\n                fieldOptions: {\n                    ...blockFieldOptions,\n                    placeholder: 'The duration of claiming period'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a duration!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'challengeDuration',\n                label: 'Challenge Duration',\n                field: 'number',\n                fieldOptions: {\n                    ...blockFieldOptions,\n                    placeholder: 'The duration of challenge period'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a duration!',\n                        required: true\n                    }\n                ]\n            },\n            {\n                name: 'finalizeDuration',\n                label: 'Finalize Duration',\n                field: 'number',\n                fieldOptions: {\n                    ...blockFieldOptions,\n                    placeholder: 'The duration of finalize period'\n                },\n                rules: [\n                    minValueRule(0),\n                    {\n                        message: 'Please enter a duration!',\n                        required: true\n                    }\n                ]\n            }\n        ];\n\n        return (\n            <Modal\n                title=\"Launch Auction\"\n                visible={visible}\n                onOk={this.handleInitAuction}\n                onCancel={onClose}\n            >\n                <Form\n                    ref={this.form}\n                    items={formItems}\n                    onValuesChange={this.handleValueChange}\n                />\n            </Modal>\n        );\n    }\n}\n\nAuctionForm.propTypes = {\n    visible: PropTypes.bool.isRequired,\n    onClose: PropTypes.func.isRequired\n};\n\nAuctionForm.contextTypes = {\n    drizzle: PropTypes.object\n};\n\nexport default AuctionForm;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport _ from 'lodash';\nimport { drizzleConnect } from 'drizzle-react';\nimport { Link } from 'dva/router';\nimport { Button, Card, List, Statistic, Row, Col, Icon } from 'antd';\n\nimport Filter from '../components/filter';\nimport AuctionForm from '../components/liba/auction-form';\nimport { getUnitByAddress, formatCurrencyValue } from '../utils/unit';\nimport { getAuctionPeriod, getCurrentPeriod, ALL_PERIODS } from '../utils/liba';\n\nconst tabList = [\n    {\n        key: 'all',\n        tab: 'All'\n    },\n    {\n        key: 'own',\n        tab: 'Own'\n    },\n    {\n        key: 'bid',\n        tab: 'Bid'\n    }\n];\n\nclass LiBA extends React.Component {\n    constructor(props, context) {\n        super(props);\n\n        this.state = { isModalVisible: false, tab: 'all', filter: {} };\n        this.contracts = context.drizzle.contracts;\n    }\n\n    onTabChange = tab => {\n        this.setState({ tab });\n    };\n\n    toggleModal = () => {\n        this.setState(prevState => ({\n            isModalVisible: !prevState.isModalVisible\n        }));\n    };\n\n    updateFilter = change => {\n        this.setState(prevState => ({\n            filter: { ...prevState.filter, ...change }\n        }));\n    };\n\n    renderAuction = auction => {\n        const { network } = this.props;\n        const { asker, value, duration, tokenAddress, period } = auction.value;\n        const unit = getUnitByAddress(network.supportedTokens, tokenAddress);\n\n        return (\n            <List.Item>\n                <Card\n                    actions={[\n                        <Link to={`/auction/${auction.args[0]}`}>\n                            <Icon type=\"eye\" title=\"View Detail\" />\n                        </Link>\n                    ]}\n                >\n                    <Row>\n                        <Col span={12}>\n                            <Statistic title=\"Asker\" value={asker} />\n                        </Col>\n                        <Col span={12}>\n                            <Statistic title=\"Period\" value={period} />\n                        </Col>\n                        <Col span={12}>\n                            <Statistic\n                                title=\"Value\"\n                                value={formatCurrencyValue(value, unit)}\n                            />\n                        </Col>\n                        <Col span={12}>\n                            <Statistic\n                                title=\"Duration\"\n                                value={`${duration} Day`}\n                            />\n                        </Col>\n                    </Row>\n                </Card>\n            </List.Item>\n        );\n    };\n\n    renderFilters = () => {\n        const periodOptions = ALL_PERIODS.map(period => [period, period]);\n        const askerOptions = _(this.auctions)\n            .map(auction => auction.value.asker)\n            .uniq()\n            .map(asker => [asker, asker])\n            .value();\n\n        return (\n            <>\n                <Filter\n                    name=\"period\"\n                    options={periodOptions}\n                    style={{ width: 100 }}\n                    onChange={this.updateFilter}\n                    allowClear\n                />\n                <Filter\n                    name=\"asker\"\n                    options={askerOptions}\n                    style={{ width: 200 }}\n                    onChange={this.updateFilter}\n                    allowClear\n                />\n            </>\n        );\n    };\n\n    renderAuctions = () => {\n        const { accounts, LiBA, network } = this.props;\n        const { tab, filter } = this.state;\n\n        let auctions = _.values(LiBA.getAuction);\n\n        if (tab === 'own') {\n            auctions = _.filter(\n                auctions,\n                auction => auction.value.asker === accounts[0]\n            );\n        }\n\n        if (tab === 'bid') {\n            auctions = _.filter(auctions, auction =>\n                _.includes(LiBA.bids, auction.args[0])\n            );\n        }\n\n        auctions = _.filter(auctions, auction => {\n            const { asker } = auction.value;\n            if (filter.asker && filter.asker !== asker) {\n                return false;\n            }\n\n            const period = getCurrentPeriod(\n                getAuctionPeriod(LiBA.getAuctionPeriod, auction),\n                _.get(network, 'block.number')\n            );\n\n            if (filter.period && filter.period !== period) {\n                return false;\n            }\n\n            auction.value.period = period;\n            return true;\n        });\n        this.auctions = auctions;\n\n        return (\n            <List\n                grid={{ gutter: 16, column: 3 }}\n                dataSource={auctions}\n                renderItem={this.renderAuction}\n            />\n        );\n    };\n\n    render() {\n        const { isModalVisible, tab } = this.state;\n        const { network } = this.props;\n\n        return (\n            <Card\n                tabList={tabList}\n                title=\"Auctions\"\n                activeTabKey={tab}\n                onTabChange={this.onTabChange}\n                extra={\n                    <Button type=\"primary\" onClick={this.toggleModal}>\n                        Launch auction\n                    </Button>\n                }\n            >\n                {this.renderFilters()}\n                {this.renderAuctions()}\n                <AuctionForm\n                    network={network}\n                    visible={isModalVisible}\n                    onClose={this.toggleModal}\n                />\n            </Card>\n        );\n    }\n}\n\nLiBA.propTypes = {\n    dispatch: PropTypes.func.isRequired\n};\n\nLiBA.contextTypes = {\n    drizzle: PropTypes.object\n};\n\nfunction mapStateToProps(state) {\n    const { contracts, accounts, LiBA, network } = state;\n\n    return {\n        accounts,\n        network,\n        LiBA: { ...LiBA, ...contracts.LiBA }\n    };\n}\n\nexport default drizzleConnect(LiBA, mapStateToProps);\n","export const EMPTY_ADDRESS = '0x0000000000000000000000000000000000000000';\nexport const RATE_PRECISION = 1;\nexport const RATE_BASE = 10 ** RATE_PRECISION;\n","import _ from 'lodash';\nimport web3 from 'web3';\n\nconst { BN } = web3.utils;\n\nexport const BID = 'Bid';\nexport const REVEAL = 'Reveal';\nexport const CLAIM = 'Claim';\nexport const CHALLENGE = 'Challenge';\nexport const FINALIZE = 'Finalize';\nexport const FINALIZED = 'Finalized';\nexport const EXPIRED = 'Expired';\nexport const UNKNOWN = 'Unknown';\nexport const ALL_PERIODS = [\n    BID,\n    REVEAL,\n    CLAIM,\n    CHALLENGE,\n    FINALIZE,\n    FINALIZED,\n    EXPIRED\n];\n\nexport const getAuctionPeriod = (auctionPeriods, auction) => {\n    return _.find(\n        auctionPeriods,\n        auctionPeriod => auctionPeriod.args[0] === auction.args[0]\n    );\n};\n\nexport const getCurrentPeriod = (auctionPeriod, blockNumber) => {\n    const {\n        bidEnd,\n        revealEnd,\n        claimEnd,\n        challengeEnd,\n        finalizeEnd,\n        finalized\n    } = _.get(auctionPeriod, 'value', {});\n\n    if (blockNumber < _.toNumber(bidEnd)) {\n        return BID;\n    }\n\n    if (blockNumber < _.toNumber(revealEnd)) {\n        return REVEAL;\n    }\n\n    if (blockNumber < _.toNumber(claimEnd)) {\n        return CLAIM;\n    }\n\n    if (blockNumber < _.toNumber(challengeEnd)) {\n        return CHALLENGE;\n    }\n\n    if (!finalized && blockNumber < _.toNumber(finalizeEnd)) {\n        return FINALIZE;\n    }\n\n    if (finalized) {\n        return FINALIZED;\n    }\n\n    return EXPIRED;\n};\n\nexport const getWinners = (auction, bids) => {\n    const winners = [];\n    let topLoser;\n    let remainingValue = auction.value.value;\n    bids.sort(compareBid);\n\n    _.forEach(bids, bid => {\n        const [bidder] = bid.args;\n        const { value } = bid.value;\n\n        if (remainingValue < 0) {\n            topLoser = bidder;\n            return false;\n        }\n\n        remainingValue -= value;\n        winners.push(bidder);\n    });\n\n    if (!topLoser) {\n        topLoser = _.last(winners);\n    }\n\n    return { winners, topLoser };\n};\n\nexport const calculateRepay = (bids, winners) => {\n    let result = new BN(0);\n\n    _.forEach(bids, bid => {\n        const [bidder] = bid.args;\n        const { value, rate } = bid.value;\n\n        if (!_.includes(winners, bidder)) {\n            return;\n        }\n\n        result = result.add(new BN(value).muln(100 + parseInt(rate)).divn(100));\n    });\n\n    return result;\n};\n\nconst compareBid = (bid1, bid2) => {\n    const { rate: rate1, celerValue: celerValue1 } = bid1.value;\n    const { rate: rate2, celerValue: celerValue2 } = bid2.value;\n\n    if (rate1 !== rate2) {\n        return rate1 - rate2;\n    }\n\n    return celerValue2 - celerValue1;\n};\n"],"sourceRoot":""}