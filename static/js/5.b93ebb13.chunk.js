(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{691:function(e,t,a){"use strict";a.d(t,"c",function(){return l}),a.d(t,"a",function(){return o}),a.d(t,"b",function(){return u});var n=a(689),r=a.n(n),i=a(331),c=a.n(i),l=(a(119),function(e,t){var a=r.a.find(e,function(e){return e.address===t});return a?a.symbol:""}),o=function(e,t){return r.a.toNumber(e)<1e5?"".concat(e," wei"):"".concat(c.a.utils.fromWei(e)," ").concat(t)},u=function(e){return r.a.toNumber(e)<1e5?"".concat(e," wei"):"".concat(c.a.utils.fromWei(e)," ether")}},695:function(e,t,a){"use strict";a.d(t,"d",function(){return n}),a.d(t,"b",function(){return r}),a.d(t,"c",function(){return i}),a.d(t,"a",function(){return c}),a.d(t,"e",function(){return l});var n={formatter:function(e){return e?"".concat(e,"ether"):""},parser:function(e){return e.replace(/[a-z]/g,"")}},r=function(e){return{formatter:function(t){return t?"".concat(t).concat(e):""},parser:function(e){return e.replace(/[A-Z]/g,"")}}},i={formatter:function(e){return e?"".concat(e,"day"):""},parser:function(e){return e.replace(/[a-z]/g,"")}},c={formatter:function(e){return e?"".concat(e,"block"):""},parser:function(e){return e.replace(/[a-z]/g,"")}},l=function(e){return{validator:function(t,a,n){a<e&&n("value is smaller than ".concat(e));n()}}}},696:function(e,t,a){"use strict";var n=a(194),r=a(195),i=a(197),c=a(196),l=a(198),o=a(1),u=a.n(o),s=a(689),d=a.n(s),m=a(865),f=a(864),b=a(866),v=a(868),p=a(111),h=a(47),g=a(703),O=a(744),j=O.a.Option,E=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,l=new Array(r),o=0;o<r;o++)l[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).defaultProps={allowClear:!0,disabled:!1,optionFilterProp:"children",placeholder:""},a.state={value:void 0},a.onChange=function(e){return a.setState({value:e})},a.getValue=function(){var e=a.props.defaultValue;return a.state.value||e},a.renderOptions=function(){var e=a.props.options;return d.a.map(e,function(e){var t=Object(g.a)(e,2),a=t[0],n=t[1];return u.a.createElement(j,{key:a,value:a},n)})},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.defaultValue,t=Object(h.a)({},d.a.omit(this.props,["options","defaultValue"]));return t.onChange||(t.onChange=this.onChange),d.a.isNil(e)||(t.defaultValue=e),u.a.createElement(O.a,Object.assign({},t,{showSearch:!0}),this.renderOptions())}}]),t}(u.a.Component),y=m.a.Item,A={wrapperCol:{sm:{span:3,offset:21},xs:{span:24}}},C={date:f.a,input:b.a,number:v.a,text:b.a.TextArea,select:E},B=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,l=new Array(r),o=0;o<r;o++)l[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).handleSubmit=function(e){var t=a.props,n=t.form,r=t.onSubmit;e.preventDefault(),n.validateFields(function(e,t){e||r(t)})},a.renderFormItems=function(){var e=a.props,t=e.form,n=e.formItemLayout,r=e.items,i=t.getFieldDecorator;return d.a.map(r,function(e){var t=e.field,a=void 0===t?"input":t,r=e.fieldOptions,c=e.initialValue,l=e.label,o=e.name,s=e.rules,m=C[a],f={initialValue:c,rules:s,getValueFromEvent:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("file"===a)return t[0].fileList;var r=t[0];if(!r||!r.target)return r;var i=r.target;return"checkbox"===i.type?i.checked:i.value}};return u.a.createElement(y,Object.assign({key:o},n,{label:l||d.a.capitalize(o)}),i(o,f)(u.a.createElement(m,r)))})},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onSubmit,a=e.submitText;return u.a.createElement(m.a,{onSubmit:this.handleSubmit},this.renderFormItems(),t!==d.a.noop&&u.a.createElement(y,A,u.a.createElement(p.a,{htmlType:"submit",type:"primary"},a)))}}]),t}(u.a.Component);B.defaultProps={formItemLayout:{labelCol:{sm:{span:8},xs:{span:24}},wrapperCol:{sm:{span:16},xs:{span:24}}},onSubmit:d.a.noop,submitText:"Save"};t.a=m.a.create({onValuesChange:function(e,t){e.onValuesChange&&e.onValuesChange(t)}})(B)},717:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"g",function(){return c}),a.d(t,"c",function(){return l}),a.d(t,"b",function(){return o}),a.d(t,"e",function(){return u}),a.d(t,"f",function(){return s}),a.d(t,"d",function(){return d}),a.d(t,"h",function(){return m}),a.d(t,"i",function(){return b});var n=a(689),r=a.n(n),i="Bid",c="Reveal",l="Claim",o="Challenge",u="Finalize",s="Finalized",d="Expired",m=function(e,t,a){var n=r.a.get(e,"block.number"),m=r.a.find(a,function(e){return e.args[0]===t.args[0]}),f=r.a.get(m,"value",{}),b=f.bidEnd,v=f.revealEnd,p=f.claimEnd,h=f.challengeEnd,g=f.finalizeEnd,O=f.finalized;return n<r.a.toNumber(b)?i:n<r.a.toNumber(v)?c:n<r.a.toNumber(p)?l:n<r.a.toNumber(h)?o:n<r.a.toNumber(g)?u:O?s:d},f=function(e,t){var a=e.value,n=a.rate1,r=a.celerValue1,i=t.value,c=i.rate2,l=i.celerValue2;return n!==c?n-c:l-r},b=function(e,t){var a=[],n=e.value.value;return t.sort(f),r.a.forEach(t,function(e){var t=e.args[0],r=e.value.value;if(n-=r,a.push(t),n<0)return!1}),a}},871:function(e,t,a){"use strict";a.r(t);var n=a(47),r=a(194),i=a(195),c=a(197),l=a(196),o=a(198),u=a(1),s=a.n(u),d=a(0),m=a.n(d),f=a(689),b=a.n(f),v=a(91),p=a(867),h=a(862),g=a(111),O=a(90),j=a(41),E=a(869),y=a(192),A=a(873),C=a(870),B=a(806),k=a(686),V=a(863),z=a(691),I=[{title:"Bidder",dataIndex:"bidder"},{title:"Rate",dataIndex:"rate"},{title:"Value",dataIndex:"value"},{title:"Celer value",dataIndex:"celerValue"}],S=function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auctionId,a=e.LiBA,r=b.a.filter(a.bidsByUser,function(e){return e.args[1]===t}).map(function(e){var t=e.args[0];return Object(n.a)({},e.value,{bidder:t,value:Object(z.b)(e.value.value)})});return s.a.createElement(V.a,{dataSource:r,columns:I,pagination:!1})}}]),t}(s.a.Component);var w=Object(v.drizzleConnect)(S,function(e){return{LiBA:e.contracts.LiBA}}),L=a(331),P=a.n(L),x=a(681),M=a(696),R=a(695),W=function(e){function t(e,a){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).onSubmit=function(){var e=n.props,t=e.auctionId,a=e.onClose;n.form.current.validateFields(function(e,r){if(!e){var i=r.celerValue,c=r.value,l=r.rate,o=r.salt;n.contracts.LiBA.methods.placeBid.cacheSend(t,P.a.utils.soliditySha3(l,P.a.utils.toWei(c.toString(),"ether"),i,o),i+o),a()}})},n.form=s.a.createRef(),n.contracts=a.drizzle.contracts,n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=[{name:"value",field:"number",fieldOptions:R.d,rules:[Object(R.e)(0),{message:"Please enter a value!",required:!0}]},{name:"rate",field:"number",rules:[Object(R.e)(0),{message:"Please enter a rate!",required:!0}]},{name:"celerValue",label:"Celer Value",field:"number",rules:[Object(R.e)(0),{message:"Please enter a celer value!",required:!0}]},{name:"salt",field:"number",rules:[Object(R.e)(0),{message:"Please enter a salt!",required:!0}]}];return s.a.createElement(x.a,{title:"Bid Auction",visible:t,onOk:this.onSubmit,onCancel:a},s.a.createElement(M.a,{ref:this.form,items:n}))}}]),t}(s.a.Component);W.contextTypes={drizzle:m.a.object};var F=W,T=function(e){function t(e,a){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).onSubmit=function(){var e=n.props,t=e.auctionId,a=e.onClose;n.form.current.validateFields(function(e,r){if(!e){var i=r.celerValue,c=r.value,l=r.rate,o=r.salt,u=r.commitmentID;n.contracts.LiBA.methods.revealBid.cacheSend(t,l,P.a.utils.toWei(c.toString(),"ether"),i,o,parseInt(u)),a()}})},n.form=s.a.createRef(),n.contracts=a.drizzle.contracts,n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.PoLC,n=e.onClose,r=b.a.map(a.commitmentsByUser,function(e){var t=e.args[1],a=Object(z.b)(e.value.availableValue);return[t,"ID: ".concat(t,", Available Value: ").concat(a)]}),i=[{name:"value",field:"number",fieldOptions:R.d,rules:[Object(R.e)(0),{message:"Please enter a value!",required:!0}]},{name:"rate",field:"number",rules:[Object(R.e)(0),{message:"Please enter a rate!",required:!0}]},{name:"celerValue",label:"Celer Value",field:"number",rules:[Object(R.e)(0),{message:"Please enter a celer value!",required:!0}]},{name:"salt",field:"number",rules:[Object(R.e)(0),{message:"Please enter a salt!",required:!0}]},{name:"commitmentID",field:"select",fieldOptions:{options:r},rules:[{message:"Please enter a commitmentID!",required:!0}]}];return s.a.createElement(x.a,{title:"Reveal Auction",visible:t,onOk:this.onSubmit,onCancel:n},s.a.createElement(M.a,{ref:this.form,items:i}))}}]),t}(s.a.Component);T.contextTypes={drizzle:m.a.object};var q=Object(v.drizzleConnect)(T,function(e){return{PoLC:e.contracts.PoLC}}),D=a(717),N=p.a.Step,U=[D.a,D.g,D.c,D.b,D.e],J=function(e){function t(e,a){var n;Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).takeAction=function(){switch(n.state.currentPeriod){case D.a:return n.toggleBidModal();case D.g:return n.toggleRevealModal();case D.c:return n.claimWinners();case D.b:return n.challengeWinners();case D.e:return n.finalizeAuction()}},n.toggleBidModal=function(){n.setState(function(e){return{isBidModalVisible:!e.isBidModalVisible}})},n.toggleRevealModal=function(){n.setState(function(e){return{isRevealModalVisible:!e.isRevealModalVisible}})},n.claimWinners=function(){var e=n.state,t=e.auction,a=e.auctionId,r=n.props.LiBA,i=Object(D.i)(t,b.a.values(r.bidsByUser));n.contracts.LiBA.methods.claimWinners(a,i).send()},n.challengeWinners=function(){var e=n.state,t=e.auction,a=e.auctionId,r=e.winners,i=n.props.LiBA,c=Object(D.i)(t,b.a.values(i.bidsByUser));b.a.isEqual(r,c)?h.a.error({message:"There is no need to challenge winners"}):n.contracts.LiBA.methods.challengeWinners(a,c).send()},n.finalizeAuction=function(){var e=n.state.auctionId;n.contracts.LiBA.methods.finalizeAuction.cacheSend(e)},n.finalizeBid=function(){var e=n.state.auctionId;n.contracts.LiBA.methods.finalizeBid.cacheSend(e)},n.collectCollateral=function(){var e=n.state.auctionId;n.contracts.LiBA.methods.collectCollateral.cacheSend(e)},n.repayAuction=function(){var e=n.state.auctionId;n.contracts.LiBA.methods.repayAuction.cacheSend(e)},n.renderAction=function(){var e=n.props.accounts,t=n.state,a=t.auction,r=t.currentPeriod,i=t.currentStep,c=t.winners,l=e[0];if(l===a.value.asker){if(r===D.f)return[s.a.createElement(g.a,{block:!0,type:"primary",onClick:n.repayAuction},"Repay")];if(!b.a.includes([D.c,D.e],r))return[]}else{if(r===D.d||-1===i&&!b.a.includes(c,l))return[s.a.createElement(g.a,{block:!0,type:"primary",onClick:n.finalizeBid},"Withdraw bid")];if(r===D.f)return[s.a.createElement(g.a,{block:!0,type:"primary",onClick:n.collectCollateral},"Collect collateral")];if(!b.a.includes([D.a,D.g,D.b],r))return[]}return[s.a.createElement(g.a,{block:!0,type:"primary",onClick:n.takeAction},r)]},n.renderAuctionDetail=function(){var e=n.state,t=e.auction,a=e.winners,r=t.value,i=r.asker,c=r.tokenAddress,l=r.collateralAddress,o=r.collateralValue,u=r.value,d=r.duration,m=r.maxRate,f=r.minValue,b=t.args[0];return s.a.createElement(O.a,{style:{marginTop:"10px"}},s.a.createElement(j.a,{span:24},s.a.createElement(E.a,{title:"Asker",value:i})),s.a.createElement(j.a,{span:24},s.a.createElement(E.a,{title:"Token Address",value:c})),s.a.createElement(j.a,{span:12},s.a.createElement(E.a,{title:"Value",value:Object(z.b)(u)})),s.a.createElement(j.a,{span:12},s.a.createElement(E.a,{title:"Duration",value:d})),s.a.createElement(j.a,{span:12},s.a.createElement(E.a,{title:"Min Value",value:Object(z.b)(f)})),s.a.createElement(j.a,{span:12},s.a.createElement(E.a,{title:"Max Rate",value:m})),o>0&&s.a.createElement(s.a.Fragment,null,"(",s.a.createElement(j.a,{span:12},s.a.createElement(E.a,{title:"Collateral Address",value:l})),s.a.createElement(j.a,{span:12},s.a.createElement(E.a,{title:"Collateral Value",value:o}))),s.a.createElement(j.a,{span:24},s.a.createElement(y.a,null,s.a.createElement(y.a.TabPane,{tab:"Bids",key:"bids"},s.a.createElement(w,{auctionId:b})),s.a.createElement(y.a.TabPane,{tab:"Winners",key:"winners"},s.a.createElement(A.a,{size:"small",bordered:!0,dataSource:a,renderItem:function(e){return s.a.createElement(A.a.Item,null,e)}})))))},n.contracts=a.drizzle.contracts,n.state={auction:null,currentStep:0,currentPeriod:"",isBidModalVisible:!1,isRevealModalVisible:!1};var i=parseInt(e.match.params.id);return n.contracts.LiBA.events.RevealBid({fromBlock:0,filter:{auctionId:i}},function(e,t){if(!e){var a=t.returnValues,r=a.auctionId,i=a.bidder;n.contracts.LiBA.methods.bidsByUser.cacheCall(i,r)}}),n.contracts.LiBA.events.ClaimWinners({fromBlock:0,filter:{auctionId:i}},function(e,t){if(!e){var a=t.returnValues.winners;n.setState({winners:a})}}),n}return Object(o.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.state,t=e.auction,a=e.currentStep,n=e.currentPeriod,r=e.isBidModalVisible,i=e.isRevealModalVisible;if(!t)return s.a.createElement(C.a,null);var c,l=t.args[0];return-1===a&&(c=s.a.createElement(B.a,{message:n,type:"info",showIcon:!0})),s.a.createElement(k.a,{title:"Auction",actions:this.renderAction()},c||s.a.createElement(p.a,{size:"small",current:a},b.a.map(U,function(e){return s.a.createElement(N,{key:e,title:e})})),this.renderAuctionDetail(),s.a.createElement(F,{auctionId:l,visible:r,onClose:this.toggleBidModal}),s.a.createElement(q,{auctionId:l,visible:i,onClose:this.toggleRevealModal}))}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.match,a=e.LiBA,n=void 0===a?{}:a,r=e.network,i=b.a.values(n.getAuction),c=b.a.find(i,function(e){return e.args[0]===t.params.id});if(!c)return{};var l=Object(D.h)(r,c,n.getAuctionPeriod),o=b.a.indexOf(U,l);return{auction:c,auctionId:c.args[0],currentStep:o,currentPeriod:l}}}]),t}(s.a.Component);J.contextTypes={drizzle:m.a.object};t.default=Object(v.drizzleConnect)(J,function(e){var t=e.accounts,a=e.contracts,r=e.LiBA;return{accounts:t,network:e.network,LiBA:Object(n.a)({},r,a.LiBA)}})}}]);
//# sourceMappingURL=5.b93ebb13.chunk.js.map